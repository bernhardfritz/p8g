"use strict";(self.webpackChunkp8g_docs=self.webpackChunkp8g_docs||[]).push([[4448],{6483:function(e,t,n){n.r(t),n.d(t,{default:function(){return T}});var o=n(3117),r=n(102),i=n(7580),a=n(6775),c=n(2949),s=n(4996),u=n(3369),d=n(7685),l=n(6649),h=n(7294),f=n(6010),p={saveButtonLoading:"saveButtonLoading_mKUY",saveButtonSuccess:"saveButtonSuccess_koEm",saveButtonFailure:"saveButtonFailure_GOXl",saveButtonIcons:"saveButtonIcons_MWWk",saveButtonIcon:"saveButtonIcon_RA5r",saveButtonLoadingIcon:"saveButtonLoadingIcon_BPRJ",saveButtonSuccessIcon:"saveButtonSuccessIcon_MMk1",saveButtonFailureIcon:"saveButtonFailureIcon_XwE3"},v=0,m=1,g=2,w=3;function b(e){var t=e.className,n=e.onSave,o=(0,h.useState)(v),r=o[0],i=o[1],a=(0,h.useRef)(void 0),c=(0,h.useCallback)((function(){i(m),n().then((function(){i(g),a.current=window.setTimeout((function(){i(v)}),1e3)})).catch((function(){i(w),a.current=window.setTimeout((function(){i(v)}),1e3)}))}),[n]);return(0,h.useEffect)((function(){return function(){return window.clearTimeout(a.current)}}),[]),h.createElement("button",{type:"button","aria-label":"Save",title:"Save",className:(0,f.Z)("clean-btn",t,p.saveButton,r===m&&p.saveButtonLoading||r===g&&p.saveButtonSuccess||r===w&&p.saveButtonFailure),onClick:c},h.createElement("span",{className:p.saveButtonIcons,"aria-hidden":"true"},h.createElement("svg",{className:p.saveButtonIcon,viewBox:"0 0 24 24"},h.createElement("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"})),h.createElement("svg",{className:p.saveButtonLoadingIcon,viewBox:"0 0 24 24"},h.createElement("path",{d:"m6 2 .01 6L10 12l-3.99 4.01L6 22h12v-6l-4-4 4-3.99V2H6zm10 14.5V20H8v-3.5l4-4 4 4z"})),h.createElement("svg",{className:p.saveButtonSuccessIcon,viewBox:"0 0 24 24"},h.createElement("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"})),h.createElement("svg",{className:p.saveButtonFailureIcon,viewBox:"0 0 24 24"},h.createElement("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}))))}function B(e,t){var n=(0,h.useState)(e),o=n[0],r=n[1];return(0,h.useEffect)((function(){var n=setTimeout((function(){r(e)}),t);return function(){clearTimeout(n)}}),[e,t]),o}var E=n(1955);var _=function(){return new Promise((function(e,t){var n=E.Z.get("access_token");if(void 0===n)var o=function(e,t,n,o){var r=navigator.userAgent,i=function(){return/\b(iPhone|iP[ao]d)/.test(r)||/\b(iP[ao]d)/.test(r)||/Android/i.test(r)||/Mobile/i.test(r)},a=void 0!==window.screenX?window.screenX:window.screenLeft,c=void 0!==window.screenY?window.screenY:window.screenTop,s=void 0!==window.outerWidth?window.outerWidth:document.documentElement.clientWidth,u=void 0!==window.outerHeight?window.outerHeight:document.documentElement.clientHeight-22,d=i()?null:n,l=i()?null:o,h=a<0?window.screen.width+a:a,f=parseInt(h+(s-d)/2,10),p=parseInt(c+(u-l)/2.5,10),v=[];null!==d&&v.push("width="+d),null!==l&&v.push("height="+l),v.push("left="+f),v.push("top="+p),v.push("scrollbars=1");var m=window.open(e,t,v.join(","));return window.focus&&m.focus(),m}("https://github.com/login/oauth/authorize?client_id=9adadcb2a0c067e95302&redirect_uri=https://bernhardfritz.github.io/p8g/login&scope=gist","_blank",480,720),r=setInterval((function(){var n=E.Z.get("access_token");void 0!==n?(clearInterval(r),e(n)):o.closed&&(clearInterval(r),t(new Error("The window has been closed before authorization.")))}),1e3);else e(n)}))},S=function(e,t){return _().then((function(n){return fetch("https://api.github.com/gists/"+e,{method:"PATCH",headers:{"Content-Type":"application/json",Accept:"application/vnd.github+json",Authorization:"Bearer "+n},body:JSON.stringify(t)})})).then((function(e){return e.json()}))},k="flex_Yzme",I="code-mirror-wrapper_FRC1",j="code-mirror-wrapper__code-mirror_ng59",z="code-mirror-wrapper__button-group_ty0I",L="code-mirror-wrapper__button-group__button_QRZ7",A="iframe_ABor",N=["onSave"];function T(){var e=(0,a.k6)(),t=(0,a.TH)(),n=(0,a.LX)(t.pathname,{path:(0,s.Z)("/editor/:id")}),o=null!==n?n.params.id:null,r=(0,s.Z)("/"),c=(0,h.useState)(null===o?"import p8g, {\n  background,\n  createCanvas,\n  rect,\n} from 'https://unpkg.com/p8g.js';\n\np8g.draw = () => {\n  background(220);\n  rect(50, 50, 100, 100);\n};\n\ncreateCanvas(320, 320);":""),d=c[0],l=c[1],f=(0,h.useState)(null),p=f[0],v=f[1];(0,h.useEffect)((function(){o&&function(e){return fetch("https://api.github.com/gists/"+e,{method:"GET",headers:{Accept:"application/vnd.github+json"}}).then((function(e){return e.json()}))}(o).then((function(e){v(e),l(e.files["sketch.js"].content)}))}),[o]);return h.createElement(u.Z,{title:"p8g.js Web Editor",description:"A web editor for p8g.js, a JavaScript library with the goal of making coding accessible to artists, designers, educators, and beginners."},h.createElement("div",{className:k},h.createElement(Z,{value:d,extensions:[(0,i.eJ)()],onChange:function(e){l(e)},height:"100%",onSave:function(){return o?_().then((function(e){return fetch("https://api.github.com/user",{method:"GET",headers:{Accept:"application/vnd.github+json",Authorization:"Bearer "+e}})})).then((function(e){return e.json()})).then((function(t){return t.login===p.owner.login?S(o,{files:{"sketch.js":{content:d}}}):function(e){return _().then((function(t){return fetch("https://api.github.com/gists/"+e+"/forks",{method:"POST",headers:{Accept:"application/vnd.github+json",Authorization:"Bearer "+t}})})).then((function(e){return e.json()}))}(o).then((function(e){return S(e.id,{description:"https://bernhardfritz.github.io/p8g/editor/"+e.id,files:{"sketch.js":{content:d}}})})).then((function(t){return e.replace(r+"editor/"+t.id)}))})):(t={files:{"sketch.js":{content:d}},public:!0},_().then((function(e){return fetch("https://api.github.com/gists",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/vnd.github+json",Authorization:"Bearer "+e},body:JSON.stringify(t)})})).then((function(e){return e.json()}))).then((function(e){return S(e.id,{description:"https://bernhardfritz.github.io/p8g/editor/"+e.id})})).then((function(t){return e.replace(r+"editor/"+t.id)}));var t}}),h.createElement(C,{message:B(d,500)})))}function Z(e){var t=e.onSave,n=(0,r.Z)(e,N),i=(0,c.I)().colorMode;return h.createElement("div",{className:I},h.createElement(d.ZP,(0,o.Z)({},n,{theme:i,className:j})),h.createElement("div",{className:z},h.createElement(b,{className:L,onSave:t})))}function C(e){var t=(0,h.useRef)(null),n=(0,h.useState)(!1),o=n[0],r=n[1];(0,h.useEffect)((function(){t.current.sendMessage("reload")}),[e.message]),(0,h.useEffect)((function(){o&&(t.current.sendMessage(e.message),r(!1))}),[o]);return h.createElement(l.Z,{forwardRef:t,src:(0,s.Z)("/preview/index.html"),className:A,onMessage:function(e){"ready"===e.message&&r(!0)}})}}}]);